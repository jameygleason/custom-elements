<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./main.js"></script>
  </head>
  <body>
    <button is="my-button" count="0">
      <span>click</span>
      <span slot="named-slot">me</span>
    </button>

    <!-- <my-button id="counter" count="0">
      <span>click</span>
      <span slot="named-slot">me</span>
    </my-button> -->

    <!-- <template id="MyButton">
      <slot></slot>
      <slot name="named-slot"></slot>
      <span class="count"></span>
    </template> -->

    <script type="module">
      import { Comp } from "./dom.js";

      Comp(
        {
          name: "MyButton",
          elm: "button",
          // template: true,
          init,
          mount,
          unmount,
          mutated,
          props: ["count"],
        },
        increment
      );

      function init() {
        console.log("INITIALIZED");
      }

      function mount() {
        console.log("MOUNTED");

        this.addEventListener("click", this.increment);

        return () => {
          console.log("UNMOUNTED FROM MOUNT CALLBACK");
          this.removeEventListener("click", this.increment);
        };
      }

      function unmount() {
        console.log("UNMOUNTED");
      }

      function mutated(attrName, oldVal, newVal) {
        console.log("MUTATED");

        let countContainer = this.get("span.count");
        if (!countContainer) {
          countContainer = dom.createElement("span");
          countContainer.classList.add("count");
          this.append(countContainer);
        }
        countContainer.textContent = " " + this.count;
      }

      function increment() {
        console.log("INCREMENTED");
        this.count = +this.count + 1;
      }
    </script>
  </body>
</html>
